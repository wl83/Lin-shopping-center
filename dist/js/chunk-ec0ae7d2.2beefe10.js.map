{"version":3,"sources":["webpack:///./src/views/shop/edititem.vue?dbdd","webpack:///src/views/shop/edititem.vue","webpack:///./src/views/shop/edititem.vue?4803","webpack:///./src/views/shop/edititem.vue","webpack:///./node_modules/core-js/modules/web.dom.iterable.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","model","value","callback","$$v","images","expression","name","info","in_stock","original_price","current_price","item_class","staticStyle","on","onSubmitClick","_v","$route","params","editType","onCancelClick","_e","staticRenderFns","components","data","item_id","images_rev","methods","purify_images","pure_images","forEach","push","item","content","replace","addHead","tmp","mounted","component","$iterators","getKeys","redefine","global","hide","Iterators","wks","ITERATOR","TO_STRING_TAG","ArrayValues","Array","DOMIterables","CSSRuleList","CSSStyleDeclaration","CSSValueList","ClientRectList","DOMRectList","DOMStringList","DOMTokenList","DataTransferItemList","FileList","HTMLAllCollection","HTMLCollection","HTMLFormElement","HTMLSelectElement","MediaList","MimeTypeArray","NamedNodeMap","NodeList","PaintRequestList","Plugin","PluginArray","SVGLengthList","SVGNumberList","SVGPathSegList","SVGPointList","SVGStringList","SVGTransformList","SourceBufferList","StyleSheetList","TextTrackCueList","TextTrackList","TouchList","collections","i","length","key","NAME","explicit","Collection","proto","prototype"],"mappings":"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","file":"js/chunk-ec0ae7d2.2beefe10.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('van-uploader',{attrs:{\"multiple\":\"\",\"max-count\":5,\"result-type\":\"dataUrl\"},model:{value:(_vm.images),callback:function ($$v) {_vm.images=$$v},expression:\"images\"}}),_c('van-cell-group',[_c('van-field',{attrs:{\"size\":\"large\",\"placeholder\":\"请输入商品名\"},model:{value:(_vm.name),callback:function ($$v) {_vm.name=$$v},expression:\"name\"}}),_c('van-field',{attrs:{\"size\":\"large\",\"type\":\"textarea\",\"placeholder\":\"请输入商品描述信息\"},model:{value:(_vm.info),callback:function ($$v) {_vm.info=$$v},expression:\"info\"}}),_c('van-field',{attrs:{\"size\":\"large\",\"type\":\"number\",\"placeholder\":\"请输入商品库存\"},model:{value:(_vm.in_stock),callback:function ($$v) {_vm.in_stock=$$v},expression:\"in_stock\"}}),_c('van-field',{attrs:{\"size\":\"large\",\"placeholder\":\"请输入商品原价\"},model:{value:(_vm.original_price),callback:function ($$v) {_vm.original_price=$$v},expression:\"original_price\"}}),_c('van-field',{attrs:{\"size\":\"large\",\"placeholder\":\"请输入商品现价\"},model:{value:(_vm.current_price),callback:function ($$v) {_vm.current_price=$$v},expression:\"current_price\"}}),_c('van-field',{attrs:{\"size\":\"large\",\"placeholder\":\"请输入商品类别\"},model:{value:(_vm.item_class),callback:function ($$v) {_vm.item_class=$$v},expression:\"item_class\"}})],1),_c('div',{staticStyle:{\"position\":\"fixed\",\"bottom\":\"0\",\"width\":\"100%\"}},[_c('div',{staticStyle:{\"padding\":\"15px\"}},[_c('van-button',{attrs:{\"round\":\"\",\"size\":\"large\",\"type\":\"primary\"},on:{\"click\":_vm.onSubmitClick}},[_vm._v(\"保存设置\")]),(this.$route.params.editType === 'editOld')?_c('van-button',{staticStyle:{\"margin-top\":\"10px\"},attrs:{\"color\":\"#f44\",\"round\":\"\",\"size\":\"large\",\"type\":\"danger\"},on:{\"click\":_vm.onCancelClick}},[_vm._v(\"删除商品\")]):_vm._e()],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <!-- 文件上传框 -->\n    <van-uploader\n      v-model=\"images\"\n      multiple\n      :max-count=\"5\"\n      result-type=\"dataUrl\"\n    />\n    <!-- 商品信息编辑 -->\n    <van-cell-group>\n      <van-field size=\"large\" v-model=\"name\" placeholder=\"请输入商品名\" />\n      <van-field\n        size=\"large\"\n        type=\"textarea\"\n        v-model=\"info\"\n        placeholder=\"请输入商品描述信息\"\n      />\n      <van-field\n        size=\"large\"\n        type=\"number\"\n        v-model=\"in_stock\"\n        placeholder=\"请输入商品库存\"\n      />\n      <van-field\n        size=\"large\"\n        v-model=\"original_price\"\n        placeholder=\"请输入商品原价\"\n      />\n      <van-field\n        size=\"large\"\n        v-model=\"current_price\"\n        placeholder=\"请输入商品现价\"\n      />\n      <van-field\n        size=\"large\"\n        v-model=\"item_class\"\n        placeholder=\"请输入商品类别\"\n      />\n    </van-cell-group>\n\n    <div style=\"position:fixed; bottom:0; width:100%;\">\n      <div style=\"padding: 15px;\">\n        <van-button round size=\"large\" type=\"primary\" @click=\"onSubmitClick\"\n          >保存设置</van-button\n        >\n        <van-button\n          v-if=\"this.$route.params.editType === 'editOld'\"\n          style=\"margin-top: 10px;\"\n          color=\"#f44\"\n          round\n          size=\"large\"\n          type=\"danger\"\n          @click=\"onCancelClick\"\n          >删除商品</van-button\n        >\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { Uploader, Field, CellGroup, Toast, Button } from \"vant\"\nimport { axios, API_URL } from \"../../api\"\nexport default {\n  components: {\n    [Uploader.name]: Uploader,\n    [Field.name]: Field,\n    [CellGroup.name]: CellGroup,\n    [Button.name]: Button\n  },\n  data() {\n    return {\n      item_id: \"\",\n      name: \"\",\n      original_price: \"\",\n      current_price: \"\",\n      info: \"\",\n      in_stock: \"\",\n      item_class: \"\",\n      images: [],\n      images_rev: []\n    }\n  },\n\n  methods: {\n    /* 上传图片格式预处理 */\n    purify_images() {\n      var pure_images = []\n      this.images.forEach(item => {\n        pure_images.push(item.content.replace(/data:image\\/[^;]+;base64,/i, \"\"))\n      })\n      return pure_images\n    },\n    /* 下载图片格式预处理 */\n    addHead() {\n      let tmp = []\n      this.images_rev.forEach(item => {\n        tmp.push({ content: \"data:image/jpeg;base64,\" + item, file: {} })\n      })\n      return tmp\n    },\n    onSubmitClick() {\n      if (\n        !this.name ||\n        !this.original_price ||\n        !this.current_price ||\n        !this.info ||\n        !this.in_stock ||\n        !this.item_class ||\n        !this.images.length\n      ) {\n        Toast(\"请填写所有项\")\n        //新添加商品表单\n      } else if (this.$route.params.editType === \"addNew\") {\n        axios\n          .post(\n            API_URL + \"item/create\",\n            {\n              images: this.purify_images(),\n              name: this.name,\n              original_price: this.original_price,\n              current_price: this.current_price,\n              in_stock: this.in_stock,\n              info: this.info,\n              item_class: this.item_class\n            },\n            {\n              headers: {\n                Authorization: this.$store.state.shop_token\n              }\n            }\n          )\n          .then(() => {\n            Toast(\"保存商品信息成功\")\n            this.$router.go(-1)\n          })\n          .catch(err => {\n            console.error(err)\n          })\n      } else {\n        // 编辑旧添加商品表单\n        axios\n          .put(\n            API_URL + \"items/\" + this.item_id,\n            {\n              images: this.purify_images(),\n              name: this.name,\n              original_price: this.original_price,\n              current_price: this.current_price,\n              item_class: this.item_class,\n              in_stock: this.in_stock,\n              info: this.info\n            },\n            {\n              headers: {\n                Authorization: this.$store.state.shop_token\n              }\n            }\n          )\n          .then(() => {\n            Toast(\"修改商品信息成功\")\n            this.$router.go(-1)\n          })\n          .catch(err => {\n            if (err.response.status == 401) {\n              this.$router.push({ name: \"shopLogin\" })\n            }\n            console.error(err)\n          })\n      }\n    },\n    onCancelClick() {\n      axios\n        .delete(API_URL + \"items/\" + this.item_id, {\n          headers: {\n            Authorization: this.$store.state.shop_token\n          }\n        })\n        .then(() => {\n          Toast(\"删除商品成功\")\n          this.$router.go(-1)\n        })\n        .catch(err => {\n          if (err.response.status == 401) {\n            this.$router.push({ name: \"shopLogin\" })\n          }\n          console.error(err)\n        })\n    }\n  },\n  /* 预载商品信息 */\n  mounted: function() {\n    if (this.$route.params.editType != \"addNew\") {\n      this.item_id = this.$route.params.item_id\n      axios\n        .get(API_URL + \"items/\" + this.item_id, {})\n        .then(response => {\n          this.name = response.data.name\n          this.current_price = response.data.current_price\n          this.original_price = response.data.original_price\n          this.in_stock = response.data.in_stock\n          this.info = response.data.info\n          this.sales = response.data.sales\n          this.shop_id = response.data.shop_id\n          this.item_class = response.data.item_class\n          this.images_rev = response.data.images\n          this.images = this.addHead(this.images_rev)\n        })\n        .catch(err => {\n          if (err.response.status == 401) {\n            this.$router.push({ name: \"shopLogin\" })\n          }\n          console.error(err)\n        })\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./edititem.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./edititem.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./edititem.vue?vue&type=template&id=b3767520&\"\nimport script from \"./edititem.vue?vue&type=script&lang=js&\"\nexport * from \"./edititem.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var $iterators = require('./es6.array.iterator');\nvar getKeys = require('./_object-keys');\nvar redefine = require('./_redefine');\nvar global = require('./_global');\nvar hide = require('./_hide');\nvar Iterators = require('./_iterators');\nvar wks = require('./_wks');\nvar ITERATOR = wks('iterator');\nvar TO_STRING_TAG = wks('toStringTag');\nvar ArrayValues = Iterators.Array;\n\nvar DOMIterables = {\n  CSSRuleList: true, // TODO: Not spec compliant, should be false.\n  CSSStyleDeclaration: false,\n  CSSValueList: false,\n  ClientRectList: false,\n  DOMRectList: false,\n  DOMStringList: false,\n  DOMTokenList: true,\n  DataTransferItemList: false,\n  FileList: false,\n  HTMLAllCollection: false,\n  HTMLCollection: false,\n  HTMLFormElement: false,\n  HTMLSelectElement: false,\n  MediaList: true, // TODO: Not spec compliant, should be false.\n  MimeTypeArray: false,\n  NamedNodeMap: false,\n  NodeList: true,\n  PaintRequestList: false,\n  Plugin: false,\n  PluginArray: false,\n  SVGLengthList: false,\n  SVGNumberList: false,\n  SVGPathSegList: false,\n  SVGPointList: false,\n  SVGStringList: false,\n  SVGTransformList: false,\n  SourceBufferList: false,\n  StyleSheetList: true, // TODO: Not spec compliant, should be false.\n  TextTrackCueList: false,\n  TextTrackList: false,\n  TouchList: false\n};\n\nfor (var collections = getKeys(DOMIterables), i = 0; i < collections.length; i++) {\n  var NAME = collections[i];\n  var explicit = DOMIterables[NAME];\n  var Collection = global[NAME];\n  var proto = Collection && Collection.prototype;\n  var key;\n  if (proto) {\n    if (!proto[ITERATOR]) hide(proto, ITERATOR, ArrayValues);\n    if (!proto[TO_STRING_TAG]) hide(proto, TO_STRING_TAG, NAME);\n    Iterators[NAME] = ArrayValues;\n    if (explicit) for (key in $iterators) if (!proto[key]) redefine(proto, key, $iterators[key], true);\n  }\n}\n"],"sourceRoot":""}